---
import { getCollection, render } from "astro:content";
import Layout from "@/layouts/Layout.astro";

export async function getStaticPaths() {
  const articles = await getCollection("articles");

  return articles.map((article) => ({
    params: { id: article.id },
    props: { article },
  }));
}

const { article } = Astro.props;
const { published, updated } = article.data;
const { Content } = await render(article);

function formatDate(date = new Date()) {
  const options: Intl.DateTimeFormatOptions = {
    month: "short",
    day: "numeric",
    year: "numeric",
  };

  return date.toLocaleDateString(undefined, options);
}
---

<Layout>
  <main>
    <h1>{article.data.title}</h1>

    <time datetime={published.toISOString()}>{formatDate(published)}</time>
    {
      updated ? (
        <>
          (updated{" "}
          <time datetime={updated.toISOString()}>{formatDate(updated)}</time>)
        </>
      ) : null
    }

    <Content />
  </main>
</Layout>
